"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[103],{90103:(a,e,l)=>{l.r(e),l.d(e,{default:()=>j});var t=l(59835),s=l(60499),u=l(86970),o=l(23459),n=l(31655),d=l(98030),i=l(46190),p=l(91569),r=l(87270),m=l(17779);const c=(0,t._)("div",{class:"",style:{height:"50px"}},null,-1),w={class:"q-pa-md"},v=["innerHTML"],_=["src"],b={key:0,class:""},g={key:1},y={class:"q-pa-md"},f=["src"],k={__name:"AssetsHold",setup(a){const{EraChain:e}=l(99407),k=(0,n.T)(),h=(0,o.Q)(),W=(0,s.iH)({asset:null,period:null,amount:null}),q=(0,s.iH)({amount:null,address:"7PsEDvVphCpXwk7NrZyAyHNR7d6Fp57Xcy",title:"Стейкхолд",message:"",encrypted:!1,fee:0,raw:0}),U=(0,s.iH)("create"),V=(0,s.iH)(!1),$=(0,s.iH)([]),F=(0,i.c)(),z=(0,t.Fl)((()=>h.assets.filter((a=>a.can_cold)))),Q=(0,t.Fl)((()=>F.balances)),Z=(0,t.Fl)((()=>k.user)),H=(0,t.Fl)((()=>F.addresses[F.currentAddressIdx].address));(0,t.wF)((async()=>{const a=await(0,p.h)("/api/p2p/hold_period");$.value=a.data}));const S=async()=>{const a=await p.h.post("/api/p2p/new_hold",{wallet:H.value,amount:W.value.amount,asset_key:W.value.asset.key,period_id:W.value.period.id});a.data.success?((0,r.d$)("positive",a.data.message),await k.get_user()):(0,r.d$)("negative",a.data.message)};async function T(){V.value=!V.value;const a=!0,l=await h.getKeyPair(),t=new e.Type.KeyPair(l),s={assetKey:W.value.asset.key,amount:W.value.amount};m.log(t),m.log(s);const u=await d.era.tranRawSendAsset(t,s,q.value.address,q.value.title,"Стейкхолд",q.value.encrypted,a);m.log(u),u.error?(0,r.d$)("negative",u.error.message):(q.value.fee=u.fee,q.value.raw=u.raw,await x()),V.value=!V.value}async function x(){const a=await d.era.broadcast64(q.value.raw);a.error?(0,r.d$)("negative",a.message):((0,r.d$)("info","Транзакция создана"),await S())}return(a,e)=>{const l=(0,t.up)("page-header"),o=(0,t.up)("q-tab"),n=(0,t.up)("q-tabs"),d=(0,t.up)("q-separator"),i=(0,t.up)("q-avatar"),p=(0,t.up)("q-item-section"),r=(0,t.up)("q-item-label"),m=(0,t.up)("q-item"),k=(0,t.up)("q-select"),h=(0,t.up)("q-input"),q=(0,t.up)("q-btn"),F=(0,t.up)("q-tab-panel"),H=(0,t.up)("q-list"),S=(0,t.up)("q-tab-panels"),x=(0,t.up)("page-body"),D=(0,t.up)("page");return(0,t.wg)(),(0,t.j4)(D,null,{default:(0,t.w5)((()=>[(0,t.Wm)(x,null,{default:(0,t.w5)((()=>[(0,t.Wm)(l),c,(0,t.Wm)(n,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{"no-caps":"",class:"bg-white",name:"create",label:a.$t("new_hold")},null,8,["label"]),(0,t.Wm)(o,{"no-caps":"",class:"bg-white",name:"list",label:a.$t("all_holds")},null,8,["label"])])),_:1},8,["modelValue"]),(0,t.Wm)(d),(0,t.Wm)(S,{modelValue:U.value,"onUpdate:modelValue":e[4]||(e[4]=a=>U.value=a),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{name:"create",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t._)("p",{innerHTML:a.$t("asset_hold_info")},null,8,v),(0,t.Wm)(k,{outlined:"",rounded:"",options:(0,s.SU)(z),modelValue:W.value.asset,"onUpdate:modelValue":e[1]||(e[1]=a=>W.value.asset=a),"option-label":"name",class:"q-mb-md",behavior:"dialog",label:a.$t("p2p_select_asset")},{option:(0,t.w5)((e=>[(0,t.Wm)(m,(0,u.vs)((0,t.F4)(e.itemProps)),{default:(0,t.w5)((()=>[(0,t.Wm)(p,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t._)("img",{src:e.opt.icon},null,8,_)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.opt.name),1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.$t("your_balance"))+": "+(0,u.zw)((0,s.SU)(Q)[e.opt.key][0][1]),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","modelValue","label"]),(0,t.Wm)(k,{outlined:"",rounded:"",options:$.value,modelValue:W.value.period,"onUpdate:modelValue":e[2]||(e[2]=a=>W.value.period=a),class:"q-mb-md",behavior:"dialog",label:a.$t("asset_hold_period")},null,8,["options","modelValue","label"]),W.value.asset?((0,t.wg)(),(0,t.iD)("div",b,[(0,t._)("p",null,(0,u.zw)(a.$t("your_balance"))+" "+(0,u.zw)((0,s.SU)(Q)[W.value.asset.key][0][1])+" "+(0,u.zw)(W.value.asset.name),1),W.value.period?((0,t.wg)(),(0,t.j4)(h,{key:0,outlined:"",rounded:"",modelValue:W.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>W.value.amount=a),class:"q-mb-md",type:"number",label:a.$t("asset_hold_amount")},null,8,["modelValue","label"])):(0,t.kq)("",!0),parseFloat(W.value.amount)>0?((0,t.wg)(),(0,t.iD)("p",g,(0,u.zw)(a.$t("asset_hold_total"))+" "+(0,u.zw)(parseFloat(W.value.amount)+parseFloat(W.value.amount)*W.value.period.percent)+" "+(0,u.zw)(W.value.asset.name),1)):(0,t.kq)("",!0),parseFloat(W.value.amount)>0?((0,t.wg)(),(0,t.j4)(q,{key:2,dense:"",class:"full-width q-py-md",onClick:T,loading:V.value,color:"positive","no-caps":"",unelevated:"",disable:parseFloat(W.value.amount)>parseFloat((0,s.SU)(Q)[W.value.asset.key][0][1]),rounded:"",label:`${a.$t("send_btn")}`},null,8,["loading","disable","label"])):(0,t.kq)("",!0)])):(0,t.kq)("",!0)])])),_:1}),(0,t.Wm)(F,{name:"list",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t._)("div",y,[(0,t.Wm)(H,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,s.SU)(Z).asset_holds,(a=>((0,t.wg)(),(0,t.j4)(m,{key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{size:"30px"},{default:(0,t.w5)((()=>[(0,t._)("img",{src:a.asset.icon,alt:""},null,8,f)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.asset.name),1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(a.amount)),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(new Date(a.expire).toLocaleDateString()),1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(a.income)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}}};var h=l(47817),W=l(70900),q=l(50926),U=l(89800),V=l(84106),$=l(57786),F=l(490),z=l(76749),Q=l(61357),Z=l(33115),H=l(13119),S=l(24455),T=l(13246),x=l(69984),D=l.n(x);const P=k,j=P;D()(k,"components",{QTabs:h.Z,QTab:W.Z,QSeparator:q.Z,QTabPanels:U.Z,QTabPanel:V.Z,QSelect:$.Z,QItem:F.Z,QItemSection:z.Z,QAvatar:Q.Z,QItemLabel:Z.Z,QInput:H.Z,QBtn:S.Z,QList:T.Z})}}]);