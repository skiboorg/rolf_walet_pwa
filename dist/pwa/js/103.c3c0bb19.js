"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[103],{90103:(a,e,l)=>{l.r(e),l.d(e,{default:()=>X});var t=l(59835),s=l(60499),u=l(86970),n=l(23459),o=l(31655),d=l(98030),i=l(46190),p=l(91569),r=l(87270),m=l(17779);const c=(0,t._)("div",{class:"",style:{height:"50px"}},null,-1),w={class:"q-pa-md"},v=["innerHTML"],_=["src"],b={key:0,class:"text-caption q-mb-md"},g={key:1,class:""},y={key:1},f={class:"q-pa-md"},k=(0,t.Uk)(" Актив "),W=(0,t.Uk)(" Отправлено/"),h=(0,t._)("br",null,null,-1),q=(0,t.Uk)("Дата "),U=(0,t.Uk)(" Ожидаемый профит/"),V=(0,t._)("br",null,null,-1),$=(0,t.Uk)("Дата выплаты "),F=(0,t.Uk)(" Cтатус "),Q=["src"],Z={__name:"AssetsHold",setup(a){const{EraChain:e}=l(99407),Z=(0,o.T)(),z=(0,n.Q)(),x=(0,s.iH)({asset:null,period:null,amount:null}),S=(0,s.iH)({amount:null,address:"7PsEDvVphCpXwk7NrZyAyHNR7d6Fp57Xcy",title:"Стейкхолд",message:"",encrypted:!1,fee:0,raw:0}),H=(0,s.iH)("create"),T=(0,s.iH)(!1),D=(0,s.iH)([]),L=(0,i.c)(),P=(0,t.Fl)((()=>z.assets.filter((a=>a.can_cold)))),C=(0,t.Fl)((()=>L.balances)),I=(0,t.Fl)((()=>Z.user)),j=(0,t.Fl)((()=>L.addresses[L.currentAddressIdx].address));(0,t.wF)((async()=>{const a=await(0,p.h)("/api/p2p/hold_period");D.value=a.data}));const A=async()=>{const a=await p.h.post("/api/p2p/new_hold",{wallet:j.value,amount:x.value.amount,asset_key:x.value.asset.key,period_id:x.value.period.id});a.data.success?((0,r.d$)("positive",a.data.message),await Z.get_user()):(0,r.d$)("negative",a.data.message)};async function K(){T.value=!T.value;const a=!0,l=await z.getKeyPair(),t=new e.Type.KeyPair(l),s={assetKey:x.value.asset.key,amount:x.value.amount};m.log(t),m.log(s);const u=await d.era.tranRawSendAsset(t,s,S.value.address,S.value.title,"Стейкхолд",S.value.encrypted,a);m.log(u),u.error?(0,r.d$)("negative",u.error.message):(S.value.fee=u.fee,S.value.raw=u.raw,await N()),T.value=!T.value}async function N(){const a=await d.era.broadcast64(S.value.raw);a.error?(0,r.d$)("negative",a.message):((0,r.d$)("info","Транзакция создана"),await A())}return(a,e)=>{const l=(0,t.up)("page-header"),n=(0,t.up)("q-tab"),o=(0,t.up)("q-tabs"),d=(0,t.up)("q-separator"),i=(0,t.up)("q-avatar"),p=(0,t.up)("q-item-section"),r=(0,t.up)("q-item-label"),m=(0,t.up)("q-item"),Z=(0,t.up)("q-select"),z=(0,t.up)("q-input"),S=(0,t.up)("q-btn"),L=(0,t.up)("q-tab-panel"),j=(0,t.up)("q-icon"),A=(0,t.up)("q-list"),N=(0,t.up)("q-tab-panels"),E=(0,t.up)("page-body"),M=(0,t.up)("page");return(0,t.wg)(),(0,t.j4)(M,null,{default:(0,t.w5)((()=>[(0,t.Wm)(E,null,{default:(0,t.w5)((()=>[(0,t.Wm)(l),c,(0,t.Wm)(o,{modelValue:H.value,"onUpdate:modelValue":e[0]||(e[0]=a=>H.value=a),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{"no-caps":"",class:"bg-white",name:"create",label:a.$t("new_hold")},null,8,["label"]),(0,t.Wm)(n,{"no-caps":"",class:"bg-white",name:"list",label:a.$t("all_holds")},null,8,["label"])])),_:1},8,["modelValue"]),(0,t.Wm)(d),(0,t.Wm)(N,{modelValue:H.value,"onUpdate:modelValue":e[4]||(e[4]=a=>H.value=a),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(L,{name:"create",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t._)("p",{innerHTML:a.$t("asset_hold_info")},null,8,v),(0,t.Wm)(Z,{outlined:"",options:(0,s.SU)(P),modelValue:x.value.asset,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value.asset=a),"option-label":"name",class:"q-mb-md",behavior:"dialog",label:a.$t("p2p_select_asset")},{option:(0,t.w5)((e=>[(0,t.Wm)(m,(0,u.vs)((0,t.F4)(e.itemProps)),{default:(0,t.w5)((()=>[(0,t.Wm)(p,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{rounded:""},{default:(0,t.w5)((()=>[(0,t._)("img",{src:e.opt.icon},null,8,_)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.opt.name),1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.$t("your_balance"))+": "+(0,u.zw)((0,s.SU)(C)[e.opt.key][0][1]),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","modelValue","label"]),(0,t.Wm)(Z,{outlined:"",options:D.value,modelValue:x.value.period,"onUpdate:modelValue":e[2]||(e[2]=a=>x.value.period=a),class:"q-mb-md",behavior:"dialog",label:a.$t("asset_hold_period")},null,8,["options","modelValue","label"]),x.value.period?((0,t.wg)(),(0,t.iD)("div",b,"* максимально возможное вознаграждение за использование Ваших активов для обеспечения ликвидности торговых пар. Вознаграждение зависит от общего сбора комиссии и PNL площадки.")):(0,t.kq)("",!0),x.value.asset?((0,t.wg)(),(0,t.iD)("div",g,[(0,t._)("p",null,(0,u.zw)(a.$t("your_balance"))+" "+(0,u.zw)((0,s.SU)(C)[x.value.asset.key][0][1])+" "+(0,u.zw)(x.value.asset.name),1),x.value.period?((0,t.wg)(),(0,t.j4)(z,{key:0,outlined:"",modelValue:x.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>x.value.amount=a),class:"q-mb-md",type:"number",label:a.$t("asset_hold_amount")},null,8,["modelValue","label"])):(0,t.kq)("",!0),parseFloat(x.value.amount)>0?((0,t.wg)(),(0,t.iD)("p",y,(0,u.zw)(a.$t("asset_hold_total"))+" "+(0,u.zw)(parseFloat(x.value.amount)+parseFloat(x.value.amount)*x.value.period.percent)+" "+(0,u.zw)(x.value.asset.name),1)):(0,t.kq)("",!0),parseFloat(x.value.amount)>0?((0,t.wg)(),(0,t.j4)(S,{key:2,dense:"",class:"full-width q-py-md",onClick:K,loading:T.value,color:"positive","no-caps":"",unelevated:"",disable:parseFloat(x.value.amount)>parseFloat((0,s.SU)(C)[x.value.asset.key][0][1]),label:`${a.$t("send_btn")}`},null,8,["loading","disable","label"])):(0,t.kq)("",!0)])):(0,t.kq)("",!0)])])),_:1}),(0,t.Wm)(L,{name:"list",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t.Wm)(A,{separator:""},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{class:"bg-grey-2"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{avatar:"",class:"text-caption"},{default:(0,t.w5)((()=>[k])),_:1}),(0,t.Wm)(p,{class:"text-caption",style:{"line-height":"110%"}},{default:(0,t.w5)((()=>[W,h,q])),_:1}),(0,t.Wm)(p,{class:"text-caption",style:{"line-height":"110%"}},{default:(0,t.w5)((()=>[U,V,$])),_:1}),(0,t.Wm)(p,{side:"",class:"text-caption"},{default:(0,t.w5)((()=>[F])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,s.SU)(I).asset_holds,(a=>((0,t.wg)(),(0,t.j4)(m,{key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{avatar:"",class:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{rounded:"",size:"30px"},{default:(0,t.w5)((()=>[(0,t._)("img",{src:a.asset.icon,alt:""},null,8,Q)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(a.amount)),1)])),_:2},1024),(0,t.Wm)(r,{caption:"",class:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(new Date(a.created_at).toLocaleDateString()),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(a.income)),1)])),_:2},1024),(0,t.Wm)(r,{caption:"",class:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(new Date(a.expire).toLocaleDateString()),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(p,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(j,{name:"pending"})])),_:1})])),_:2},1024)))),128))])),_:1})])])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}}};var z=l(47817),x=l(70900),S=l(50926),H=l(89800),T=l(84106),D=l(57786),L=l(490),P=l(76749),C=l(61357),I=l(33115),j=l(13119),A=l(24455),K=l(13246),N=l(22857),E=l(69984),M=l.n(E);const R=Z,X=R;M()(Z,"components",{QTabs:z.Z,QTab:x.Z,QSeparator:S.Z,QTabPanels:H.Z,QTabPanel:T.Z,QSelect:D.Z,QItem:L.Z,QItemSection:P.Z,QAvatar:C.Z,QItemLabel:I.Z,QInput:j.Z,QBtn:A.Z,QList:K.Z,QIcon:N.Z})}}]);