"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[5453],{45453:(e,a,l)=>{l.r(a),l.d(a,{default:()=>K});var t=l(59835),u=l(86970),n=l(60499),s=l(91569),d=l(18910),r=l(46190),o=l(31655),i=l(99407),p=l(98030),w=l(87270),c=l(23459),m=l(17779);const _=(0,t._)("div",{class:"",style:{height:"50px"}},null,-1),v={class:"q-pa-md"},g=(0,t._)("br",null,null,-1),y=(0,t._)("br",null,null,-1),b=(0,t._)("span",{class:"text-bold"},"ВНИМАНИЕ",-1),f=(0,t.Uk)(" откуп будет происходить согласно росту ликвидного курса монеты."),k=(0,t._)("br",null,null,-1),q=(0,t._)("br",null,null,-1),h=(0,t.Uk)(),U=(0,t._)("span",{class:"text-bold text-negative"}," Отправленные монеты на откуп, будут выкуплены за рубли и вернуть монеты уже не получится.",-1),W={class:"text-bold"},F={key:1,class:"no-margin text-bold"},S=(0,t.Uk)("Дата"),$=(0,t.Uk)("Остаток"),z=(0,t.Uk)("Выкуплено"),I={__name:"Shance",setup(e){const a=(0,c.Q)(),l=(0,o.T)(),I=(0,d.yj)(),L=(0,n.iH)(0),x=(0,n.iH)([]),Q=(0,r.c)(),Z=(0,n.iH)(!1),H=(0,n.iH)({amount:null,address:"7PsEDvVphCpXwk7NrZyAyHNR7d6Fp57Xcy",title:`Выкуп по ${I.query.ip}`,message:"",encrypted:!1,fee:0,raw:0}),j=(0,t.Fl)((()=>Q.addresses[Q.currentAddressIdx].address)),C=(0,t.Fl)((()=>Q.balances)),D=(0,t.Fl)((()=>l.user));async function O(){Z.value=!Z.value;const e=!0,l=await a.getKeyPair(),t=new i.EraChain.Type.KeyPair(l),u={assetKey:2,amount:L.value};m.log(t),m.log(u);const n=await p.era.tranRawSendAsset(t,u,H.value.address,H.value.title,"Откуп OLF",H.value.encrypted,e);m.log(n),n.error?(0,w.d$)("negative",n.error.message):(H.value.fee=n.fee,H.value.raw=n.raw,await K()),Z.value=!Z.value}async function K(){const e=await p.era.broadcast64(H.value.raw);e.error?(0,w.d$)("negative",e.message):((0,w.d$)("info","Транзакция создана"),await R())}(0,t.wF)((async()=>{m.log(I.query.i),m.log(I.query.ip),x.value=D.value.shance_holds.filter((e=>e.price.id===parseInt(I.query.i)))}));const R=async()=>{const e=await s.h.post("/api/p2p/new_shance",{wallet:j.value,amount:L.value,shance_id:I.query.i});e.data.success?((0,w.d$)("positive",e.data.message),await l.get_user()):(0,w.d$)("negative",e.data.message),Z.value=!1};return(e,a)=>{const l=(0,t.up)("page-header"),s=(0,t.up)("q-input"),d=(0,t.up)("q-btn"),r=(0,t.up)("q-item-label"),o=(0,t.up)("q-item-section"),i=(0,t.up)("q-item"),p=(0,t.up)("q-list"),w=(0,t.up)("page-body"),c=(0,t.up)("page");return(0,t.wg)(),(0,t.j4)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(l),_,(0,t._)("div",v,[(0,t._)("p",null,[(0,t.Uk)("Просто выбери количество монет и получи откуп отправленных тобой монет по цене "+(0,u.zw)((0,n.SU)(I).query.ip)+" за каждую монету.",1),g,y,b,f,k,q,h,U]),(0,t._)("p",W,(0,u.zw)(e.$t("your_balance"))+" OLF: "+(0,u.zw)((0,n.SU)(C)[2][0][1]),1),(0,t.Wm)(s,{outlined:"",modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e),label:"Сумма OLF",class:"q-mb-md",type:"number"},null,8,["modelValue"]),parseFloat(L.value)>0?((0,t.wg)(),(0,t.j4)(d,{key:0,dense:"",class:"full-width q-py-md q-mb-lg",onClick:O,loading:Z.value,color:"positive","no-caps":"",unelevated:"",disable:parseFloat(L.value)>parseFloat((0,n.SU)(C)[2][0][1]),label:`${e.$t("send_btn")}`},null,8,["loading","disable","label"])):(0,t.kq)("",!0),x.value.length>0?((0,t.wg)(),(0,t.iD)("p",F,"Текущие выкупы")):(0,t.kq)("",!0),x.value.length>0?((0,t.wg)(),(0,t.j4)(p,{key:2,dense:"",separator:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[S])),_:1})])),_:1}),(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[$])),_:1})])),_:1}),(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[z])),_:1})])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(x.value,(e=>((0,t.wg)(),(0,t.j4)(i,{dense:"",key:e.id},{default:(0,t.w5)((()=>[(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(new Date(e.created_at).toLocaleDateString()),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{overline:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(e.amount))+" OLF",1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(e.amount)*parseInt((0,n.SU)(I).query.ip))+" RUB",1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(o,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(e.ostatok))+" OLF",1)])),_:2},1024),(0,t.Wm)(r,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat(e.ostatok)*parseInt((0,n.SU)(I).query.ip))+" RUB",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,t.kq)("",!0)])])),_:1})])),_:1})}}};var L=l(13119),x=l(24455),Q=l(13246),Z=l(490),H=l(76749),j=l(33115),C=l(69984),D=l.n(C);const O=I,K=O;D()(I,"components",{QInput:L.Z,QBtn:x.Z,QList:Q.Z,QItem:Z.Z,QItemSection:H.Z,QItemLabel:j.Z})}}]);