"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[1950],{21950:(e,l,a)=>{a.r(l),a.d(l,{default:()=>A});a(40702);var u=a(59835),t=a(60499),n=a(61957),r=a(86970),s=a(91569),o=a(87270),d=a(46190),i=a(99407),m=a(98030),v=a(23459),p=a(17779);const c=(0,u._)("div",{class:"",style:{height:"50px"}},null,-1),y={class:"q-pa-md"},g={key:0},w=(0,u._)("p",{class:"text-bold"},"Заявка на создание актива",-1),b={key:0,class:"text-negative text-bold"},f=(0,u.Uk)(" За выпуск актива будет держана коммиссия"),V=(0,u._)("br",null,null,-1),_=(0,u._)("br",null,null,-1),h={key:1},U=(0,u._)("p",{class:"text-negative text-bold text-center"},"Для создания актива нужно быть верифицированным пользователем и иметь на балансе 1000 RUPAY",-1),k=[U],x={__name:"CreateAsset",setup(e){const l=(0,d.c)(),a=(0,t.iH)(null),U=(0,t.iH)(!1),x=(0,t.iH)(""),F=(0,v.Q)(),W=(0,t.iH)({amount:null,accurase:null,title:null,text:null,add_to_market:!1,course_rub:null,wallet:null,telega:null}),S=(0,u.Fl)((()=>{if(W.value.amount)return 10*Math.ceil(W.value.amount/1e5)})),q=(0,u.Fl)((()=>{if(W.value.amount)return.2*Math.ceil(W.value.amount/1e5)})),z=(0,u.Fl)((()=>l.verifyPersonData)),C=(0,u.Fl)((()=>l.addresses[l.currentAddressIdx].address)),P=(0,u.Fl)((()=>parseFloat($.value[1][0][1])+parseFloat($.value[1][1][1]))),$=(0,u.Fl)((()=>l.balances)),A=async()=>{U.value=!U.value,x.value="",W.value.wallet=C.value;let e=new FormData;for(let[l,a]of Object.entries(W.value))e.append(l,JSON.stringify(a));e.append("image",a.value),(0,s.h)({method:"post",url:"/api/settings/new_asset",data:e,headers:{"Content-Type":"multipart/form-data"}}).then((e=>{(0,o.d$)("positive","Заявка успешно отправлена")})).catch((e=>{let l=Object.keys(e.response.data);for(let a of l)x.value+=e.response.data[a][0];(0,o.d$)("negative",x.value)})),U.value=!U.value},D=(0,t.iH)({amount:null,address:"7PsEDvVphCpXwk7NrZyAyHNR7d6Fp57Xcy",title:"Заявка создания актива",message:"",encrypted:!1,fee:0,raw:0});async function H(){U.value=!U.value;const e=!0,l=await F.getKeyPair(),a=new i.EraChain.Type.KeyPair(l),u={assetKey:1,amount:S.value};p.log(a),p.log(u);const t=await m.era.tranRawSendAsset(a,u,D.value.address,D.value.title,D.value.message,D.value.encrypted,e);p.log(t),t.error?(0,o.d$)("negative",t.error.message):(D.value.fee=t.fee,D.value.raw=t.raw,await Q()),U.value=!U.value}async function K(){U.value=!U.value;const e=!0,l=await F.getKeyPair(),a=new i.EraChain.Type.KeyPair(l),u={assetKey:2,amount:q.value};p.log(a),p.log(u);const t=await m.era.tranRawSendAsset(a,u,D.value.address,D.value.title,D.value.message,D.value.encrypted,e);p.log(t),t.error?(0,o.d$)("negative",t.error.message):(D.value.fee=t.fee,D.value.raw=t.raw,await R()),U.value=!U.value}async function Q(){const e=await m.era.broadcast64(D.value.raw);e.error?(0,o.d$)("negative",e.message):((0,o.d$)("info","Транзакция создана"),await K())}async function R(){const e=await m.era.broadcast64(D.value.raw);e.error?(0,o.d$)("negative",e.message):(await A(),(0,o.d$)("info","Транзакция создана"))}return(e,l)=>{const s=(0,u.up)("page-header"),o=(0,u.up)("q-file"),d=(0,u.up)("q-input"),i=(0,u.up)("q-checkbox"),m=(0,u.up)("q-btn"),v=(0,u.up)("q-form"),p=(0,u.up)("page-body"),x=(0,u.up)("page");return(0,u.wg)(),(0,u.j4)(x,null,{default:(0,u.w5)((()=>[(0,u.Wm)(p,null,{default:(0,u.w5)((()=>[(0,u.Wm)(s),c,(0,u._)("div",y,[parseFloat((0,t.SU)(P))>=1e3&&(0,t.SU)(z)?((0,u.wg)(),(0,u.iD)("div",g,[w,(0,u.Wm)(v,{onSubmit:(0,n.iM)(H,["prevent"])},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{outlined:"",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),label:"Иконка актива*","lazy-rules":"",rules:[e=>null!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.title,"onUpdate:modelValue":l[1]||(l[1]=e=>W.value.title=e),label:"Название актива*","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.amount,"onUpdate:modelValue":l[2]||(l[2]=e=>W.value.amount=e),label:"Выпускаемый объем*",type:"number","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.accurase,"onUpdate:modelValue":l[3]||(l[3]=e=>W.value.accurase=e),label:"Кол-во знаков после запятой*",type:"number","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.course_rub,"onUpdate:modelValue":l[4]||(l[4]=e=>W.value.course_rub=e),label:"Курс в RUB*",type:"number","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.text,"onUpdate:modelValue":l[5]||(l[5]=e=>W.value.text=e),class:"q-mb-md",label:"Описание",type:"textarea"},null,8,["modelValue"]),(0,u.Wm)(d,{outlined:"",modelValue:W.value.telega,"onUpdate:modelValue":l[6]||(l[6]=e=>W.value.telega=e),label:"Ваш телеграм для связи*",type:"number","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(i,{modelValue:W.value.add_to_market,"onUpdate:modelValue":l[7]||(l[7]=e=>W.value.add_to_market=e),label:"Разместить на бирже?"},null,8,["modelValue"]),(0,t.SU)(S)?((0,u.wg)(),(0,u.iD)("p",b,[f,V,(0,u.Uk)(" "+(0,r.zw)((0,t.SU)(S))+" RUPAY",1),_,(0,u.Uk)(" "+(0,r.zw)((0,t.SU)(q))+" OLF ",1)])):(0,u.kq)("",!0),(0,u.Wm)(m,{loading:U.value,label:"Отправить заявку",color:"primary","no-caps":"",class:"full-width",padding:"md",type:"submit"},null,8,["loading"])])),_:1},8,["onSubmit"])])):((0,u.wg)(),(0,u.iD)("div",h,k))])])),_:1})])),_:1})}}};var F=a(8326),W=a(33837),S=a(13119),q=a(11221),z=a(24455),C=a(69984),P=a.n(C);const $=x,A=$;P()(x,"components",{QForm:F.Z,QFile:W.Z,QInput:S.Z,QCheckbox:q.Z,QBtn:z.Z})}}]);