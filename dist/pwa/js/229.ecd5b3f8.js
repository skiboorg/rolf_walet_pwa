"use strict";(globalThis["webpackChunkrolf_wallet"]=globalThis["webpackChunkrolf_wallet"]||[]).push([[229],{75008:(e,a,l)=>{l.d(a,{C:()=>d,d:()=>n});var t=l(13433),s=l(17779);const n=({seed:e,password:a})=>{const l={status:!0,seed:e},s=t.createCipher("aes192",a);return s.update(JSON.stringify(l),"utf8","hex")+s.final("hex")},d=({hash:e,password:a})=>{try{const l=t.createDecipher("aes192",a),s=l.update(e,"hex","utf8")+l.final("utf8"),n=JSON.parse(s);return!!n.status&&n.seed}catch(l){return s.log(l),!1}}},14895:(e,a,l)=>{l.d(a,{Z:()=>h});var t=l(59835),s=l(60499),n=l(43463),d=l(87270),u=l(75008),o=l(17779);const i={props:["transactionInfo"]},c=Object.assign(i,{__name:"PinCodeModal",emits:["pincode_ок"],setup(e,{emit:a}){const l=(0,n.s)();function i(e){const t=localStorage.getItem("hash"),s=(0,u.C)({hash:t,password:e});o.log(s),s?(a("pincode_ок"),l.togglePinCodeModalVisible()):(0,d.d)("negative","Неверный пинкод")}return(e,a)=>{const n=(0,t.up)("pin-code"),d=(0,t.up)("q-btn"),u=(0,t.up)("q-card-section"),o=(0,t.up)("q-card"),c=(0,t.up)("q-dialog");return(0,t.wg)(),(0,t.j4)(c,{modelValue:(0,s.SU)(l).pinCodeModalVisible,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,s.SU)(l).pinCodeModalVisible=e),persistent:"",maximized:"","transition-show":"slide-left","transition-hide":"slide-right"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{class:"bg-white fullscreen"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{class:"flex column items-center justify-center fullscreen"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{showDigits:!1,onPincode_ready:i}),(0,t.Wm)(d,{class:"q-mt-md",onClick:a[0]||(a[0]=e=>(0,s.SU)(l).togglePinCodeModalVisible()),"no-caps":"",unelevated:"",rounded:"",color:"negative",label:"Отмена"})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}});var r=l(32074),m=l(44458),p=l(63190),w=l(24455),v=l(69984),g=l.n(v);const f=c,h=f;g()(c,"components",{QDialog:r.Z,QCard:m.Z,QCardSection:p.Z,QBtn:w.Z})},64229:(e,a,l)=>{l.r(a),l.d(a,{default:()=>G});var t=l(59835),s=l(86970),n=l(60499),d=l(91569),u=l(14895),o=l(43463),i=l(87270),c=l(18910),r=l(98030),m=l(46190),p=l(23459),w=l(17779);const v=(0,t._)("div",{class:"",style:{height:"50px"}},null,-1),g=(0,t._)("div",{class:"",style:{height:"50px"}},null,-1),f=(0,t.Uk)("Ваш баланс"),h=(0,t.Uk)("Количество отправляемых взносов "),_={class:"text-bold"},b=(0,t._)("p",{class:"text-bold text-caption text-center text-negative q-mb-none"},"ВНИМАНИЕ ВЫ СОВЕРШАЕТЕ НЕВОЗВРАТНЫЙ ВЗНОС",-1),W={class:"q-mb-md"},k=(0,t.Uk)(" Подтверждение отправки актива "),x=(0,t.Uk)("Актив"),y=(0,t.Uk)("OLF"),q=(0,t.Uk)("Количество"),C=(0,t.Uk)("Комиссия транзакции"),U={key:0},Z={key:1},Q={__name:"Buy_part",setup(e){const a=(0,o.s)(),{EraChain:Q}=((0,c.tv)(),l(99407)),V=(0,m.c)(),S=(0,p.Q)(),F=250,H=F+.01*F+.002;let M=(0,n.iH)(!1);const O=(0,n.iH)(!1),j=(0,n.iH)(0),L=(0,n.iH)(0),P=(0,n.iH)(!1),z=(0,c.yj)();let D=(0,n.iH)(null);(0,t.bv)((async()=>{L.value=parseInt(I.value[2][0][1]/H),L.value>0?j.value=1:j.value=0}));const I=(0,t.Fl)((()=>V.balances)),A=(0,t.Fl)((()=>(T.value.amount=j.value*F,j.value*F))),B=(0,t.Fl)((()=>V.addresses[V.currentAddressIdx].address));function N(){a.togglePinCodeModalVisible()}(0,t.bv)((async()=>{D.value=z.params.asset_key}));const T=(0,n.iH)({amount:null,address:"7GMmxFHoXhrTM4vbZyRAFsZ2hGtfbqkyhU",title:"Покупка невозвратного паевого взноса",message:"",encrypted:!1,fee:0,raw:0});function G(){T.value={amount:null,address:"7NBHJjDugvtNq9GsMMcwcbx7yNMAn47fLH",title:"Покупка невозвратного паевого взноса",message:"",encrypted:!1,fee:0,raw:0}}async function J(){O.value=!O.value;const e=!0,a=await S.getKeyPair(),l=new Q.Type.KeyPair(a),t={assetKey:"2",amount:T.value.amount};w.log(l),w.log(t);const s=await r.era.tranRawSendAsset(l,t,T.value.address,T.value.title,`Приобретено ${j.value} долей`,T.value.encrypted,e);w.log(s),s.error?(0,i.d)("negative",s.error.message):(T.value.fee=s.fee,T.value.raw=s.raw),O.value=!O.value}async function K(){O.value=!O.value;const e=await d.h.get(`/api/user/check_address?wallet=${B.value}`);if(e.data.success){(0,i.d)("positive",e.data.message);const a=await r.era.broadcast64(T.value.raw);if(w.log(a),a.error)(0,i.d)("negative",a.message);else{(0,i.d)("info","Транзакция создана"),M.value=!1;const e=await d.h.post("/api/user/addition_balance",{wallet:B.value,tx:a.signature,parts:j.value});e.data.success?((0,i.d)("positive",e.data.message),P.value=!1,j.value=0):(0,i.d)("negative",e.data.message)}}else(0,i.d)("negative",e.data.message);O.value=!O.value}return(e,a)=>{const l=(0,t.up)("q-btn"),d=(0,t.up)("unconfirmed-tx-icon"),o=(0,t.up)("q-header"),i=(0,t.up)("q-item-section"),c=(0,t.up)("q-item"),r=(0,t.up)("q-slider"),m=(0,t.up)("q-separator"),p=(0,t.up)("q-checkbox"),w=(0,t.up)("btn"),Q=(0,t.up)("q-list"),V=(0,t.up)("q-card-section"),S=(0,t.up)("page-body"),F=(0,t.up)("q-card-actions"),z=(0,t.up)("q-card"),D=(0,t.up)("q-dialog"),B=(0,t.up)("page"),$=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S,null,{default:(0,t.w5)((()=>[(0,t.Wm)(o,{reveal:"",class:"text-white q-py-sm items-center flex justify-between"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{"no-caps":"",label:"Внести паевой взнос",onClick:a[0]||(a[0]=a=>e.$router.back()),icon:"las la-angle-left",unelevated:""}),(0,t.Wm)(d)])),_:1}),v,g,(0,t.Wm)(V,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{side:"",class:"text-weight-bold text-dark"},{default:(0,t.w5)((()=>[f])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)((0,n.SU)(I)[2][0][1])+" OLF",1)])),_:1})])),_:1}),(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{side:"",class:"text-weight-bold text-dark"},{default:(0,t.w5)((()=>[(0,t.Uk)("Стоимость одного невозвратного паевого взноса с учетом комиссии сети "+(0,s.zw)(H)+" OLF")])),_:1})])),_:1}),(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[h,(0,t._)("span",_,(0,s.zw)(j.value)+" ("+(0,s.zw)((0,n.SU)(A))+" OLF)",1)])),_:1})])),_:1}),(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:j.value,"onUpdate:modelValue":a[1]||(a[1]=e=>j.value=e),"marker-labels":"",min:L.value>0?1:0,max:L.value},null,8,["modelValue","min","max"])])),_:1})])),_:1}),(0,t.Wm)(m,{class:"q-my-md"}),b,(0,t._)("div",W,[(0,t.Wm)(p,{modelValue:P.value,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value=e),label:"Принимаю"},null,8,["modelValue"])]),(0,t.Wm)(w,{label:"Отправить",onClick:N,disabled:!(P.value&&j.value>0),outline:!1},null,8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(D,{modelValue:(0,n.SU)(M),"onUpdate:modelValue":a[3]||(a[3]=e=>(0,n.dq)(M)?M.value=e:M=e),persistent:"","transition-show":"scale","transition-hide":"scale",onBeforeHide:G},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{class:"bg-white text-dark",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{class:"text-weight-bold"},{default:(0,t.w5)((()=>[k])),_:1}),(0,t.Wm)(V,{class:"q-py-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,{dense:"",separator:"",class:"q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[x])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[y])),_:1})])),_:1}),(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[q])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(T.value.amount)+" OLF",1)])),_:1})])),_:1}),(0,t.Wm)(c,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[C])),_:1}),(0,t.Wm)(i,{class:"text-caption"},{default:(0,t.w5)((()=>[T.value.fee>0?((0,t.wg)(),(0,t.iD)("span",U,(0,s.zw)(.01*T.value.amount)+" OLF",1)):(0,t.kq)("",!0),T.value.fee>0?((0,t.wg)(),(0,t.iD)("span",Z,"+ газ "+(0,s.zw)(T.value.fee)+" OLF",1)):(0,t.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(F,{class:"bg-white text-teal"},{default:(0,t.w5)((()=>[0===T.value.fee?((0,t.wg)(),(0,t.j4)(l,{key:0,label:"Расчет комиссии",rounded:"",loading:O.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"info",onClick:J,outline:!1},null,8,["loading"])):((0,t.wg)(),(0,t.j4)(l,{key:1,label:"Подтвердить",rounded:"",loading:O.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"positive",onClick:K,outline:!1},null,8,["loading"])),(0,t.wy)((0,t.Wm)(l,{label:"Отменить",rounded:"","no-caps":"",color:"negative",class:"full-width",unelevated:"",outline:"",loading:O.value},null,8,["loading"]),[[$]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)((0,n.SU)(u.Z),{onPincode_ок:a[4]||(a[4]=e=>(0,n.dq)(M)?M.value=!0:M=!0)})])),_:1})}}};var V=l(16602),S=l(24455),F=l(63190),H=l(13246),M=l(490),O=l(76749),j=l(28423),L=l(50926),P=l(11221),z=l(32074),D=l(44458),I=l(11821),A=l(62146),B=l(69984),N=l.n(B);const T=Q,G=T;N()(Q,"components",{QHeader:V.Z,QBtn:S.Z,QCardSection:F.Z,QList:H.Z,QItem:M.Z,QItemSection:O.Z,QSlider:j.Z,QSeparator:L.Z,QCheckbox:P.Z,QDialog:z.Z,QCard:D.Z,QCardActions:I.Z}),N()(Q,"directives",{ClosePopup:A.Z})}}]);